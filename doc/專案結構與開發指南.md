# Nuxt.js 觀光活動地圖專案結構與開發指南

## 1. 完整專案結構

```
nuxt-tourism-map/
├── .env.example                 # 環境變數範例
├── .gitignore                   # Git 忽略文件
├── nuxt.config.ts               # Nuxt 配置
├── package.json                 # 依賴管理
├── tailwind.config.js           # Tailwind CSS 配置
├── drizzle.config.ts           # Drizzle ORM 配置
├── README.md                    # 專案說明
│
├── assets/                      # 需要處理的資源
│   ├── css/
│   │   └── main.css            # 全域樣式
│   ├── images/                 # 圖片資源
│   └── icons/                  # 圖標資源
│
├── components/                  # Vue 組件
│   ├── Activity/               # 活動相關組件
│   │   ├── ActivityCard.vue    # 活動卡片
│   │   ├── ActivityList.vue    # 活動列表
│   │   ├── ActivityInfo.vue    # 活動詳情
│   │   └── ActivityModal.vue   # 活動彈窗
│   ├── Map/                    # 地圖相關組件
│   │   ├── ActivityMap.vue     # 主地圖組件
│   │   ├── MarkerCluster.vue   # 標記聚合
│   │   ├── InfoWindow.vue      # 資訊窗
│   │   └── MapControls.vue     # 地圖控制
│   ├── Filter/                 # 篩選相關組件
│   │   ├── FilterPanel.vue     # 主篩選面板
│   │   ├── CategoryFilter.vue  # 類別篩選
│   │   ├── LocationFilter.vue  # 位置篩選
│   │   ├── DateFilter.vue      # 時間篩選
│   │   └── AdvancedFilter.vue  # 進階篩選
│   ├── UI/                     # 基礎 UI 組件
│   │   ├── BaseButton.vue      # 基礎按鈕
│   │   ├── BaseCard.vue        # 基礎卡片
│   │   ├── BaseModal.vue       # 基礎彈窗
│   │   ├── BaseInput.vue       # 基礎輸入框
│   │   ├── LoadingSpinner.vue  # 載入動畫
│   │   └── ErrorBoundary.vue   # 錯誤邊界
│   └── Layout/                 # 佈局組件
│       ├── Header.vue          # 頁面頭部
│       ├── Footer.vue          # 頁面底部
│       ├── Sidebar.vue         # 側邊欄
│       └── MobileMenu.vue      # 手機選單
│
├── composables/                 # Composition API
│   ├── useActivities.ts        # 活動管理
│   ├── useMap.ts               # 地圖功能
│   ├── useFilters.ts           # 篩選功能
│   ├── useGeolocation.ts       # 地理定位
│   ├── useFavorites.ts         # 收藏功能
│   ├── useCategories.ts        # 分類管理
│   └── useValidation.ts        # 表單驗證
│
├── db/                         # 資料庫相關
│   ├── index.ts                # 資料庫連接
│   ├── schema.ts               # 資料表定義
│   ├── migrations/             # 遷移文件
│   │   ├── 0001_init.sql
│   │   └── 0002_add_indexes.sql
│   ├── seeds/                  # 種子資料
│   │   ├── categories.ts       # 分類資料
│   │   └── sample-activities.ts # 範例活動
│   └── queries/                # 查詢函數
│       ├── activities.ts       # 活動查詢
│       ├── locations.ts        # 地點查詢
│       └── search.ts           # 搜尋查詢
│
├── layouts/                    # 頁面佈局
│   ├── default.vue             # 預設佈局
│   ├── map.vue                 # 地圖佈局
│   └── admin.vue               # 管理後台佈局
│
├── middleware/                 # 中間件
│   ├── auth.ts                 # 身份驗證
│   └── analytics.ts            # 分析追蹤
│
├── pages/                      # 頁面路由
│   ├── index.vue               # 首頁 (地圖)
│   ├── activity/               # 活動頁面
│   │   ├── [id].vue           # 活動詳情
│   │   └── index.vue          # 活動列表
│   ├── favorites.vue           # 我的收藏
│   ├── search.vue              # 搜尋結果
│   ├── about.vue               # 關於我們
│   ├── privacy.vue             # 隱私政策
│   └── admin/                  # 管理後台
│       ├── index.vue          # 後台首頁
│       ├── activities.vue      # 活動管理
│       └── validation.vue      # 驗證管理
│
├── plugins/                    # 插件
│   ├── element-plus.client.ts  # Element Plus 配置
│   ├── google-maps.client.ts   # Google Maps 配置
│   └── analytics.client.ts     # 分析工具配置
│
├── public/                     # 靜態資源
│   ├── favicon.ico             # 網站圖標
│   ├── manifest.json           # PWA 配置
│   ├── sw.js                   # Service Worker
│   └── icons/                  # 活動類別圖標
│       ├── traditional.svg
│       ├── romantic.svg
│       └── ...
│
├── server/                     # 服務端 API
│   ├── api/                    # API 端點
│   │   ├── activities/         # 活動相關 API
│   │   │   ├── index.get.ts   # 取得活動列表
│   │   │   ├── [id].get.ts    # 取得單一活動
│   │   │   ├── search.post.ts  # 搜尋活動
│   │   │   └── nearby.get.ts   # 附近活動
│   │   ├── categories/         # 分類相關 API
│   │   │   └── index.get.ts   # 取得所有分類
│   │   ├── validation/         # 驗證相關 API
│   │   │   ├── submit.post.ts  # 提交驗證
│   │   │   └── status.get.ts   # 查詢狀態
│   │   └── crawler/            # 爬蟲相關 API
│   │       ├── trigger.post.ts # 觸發爬蟲
│   │       └── status.get.ts   # 爬蟲狀態
│   ├── middleware/             # 服務端中間件
│   │   ├── cors.ts            # CORS 設定
│   │   ├── rate-limit.ts      # 速率限制
│   │   └── error-handler.ts    # 錯誤處理
│   └── utils/                  # 服務端工具
│       ├── db.ts              # 資料庫工具
│       ├── validation.ts       # 資料驗證
│       ├── claude-api.ts       # Claude API 整合
│       └── geocoding.ts        # 地理編碼
│
├── stores/                     # Pinia 狀態管理
│   ├── activities.ts           # 活動狀態
│   ├── filters.ts              # 篩選狀態
│   ├── map.ts                  # 地圖狀態
│   ├── user.ts                 # 使用者狀態
│   └── favorites.ts            # 收藏狀態
│
├── types/                      # TypeScript 類型定義
│   ├── activity.ts             # 活動類型
│   ├── location.ts             # 地點類型
│   ├── filter.ts               # 篩選類型
│   ├── api.ts                  # API 回應類型
│   └── global.d.ts             # 全域類型定義
│
├── utils/                      # 工具函數
│   ├── date.ts                 # 日期處理
│   ├── geo.ts                  # 地理計算
│   ├── format.ts               # 格式化工具
│   ├── constants.ts            # 常數定義
│   └── validation.ts           # 驗證規則
│
└── data/                       # 資料文件 (gitignore)
    ├── tourism.db              # SQLite 資料庫
    └── uploads/                # 上傳文件
```

## 2. 關鍵文件配置

### 2.1 package.json
```json
{
  "name": "nuxt-tourism-map",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "nuxt dev",
    "build": "nuxt build",
    "preview": "nuxt preview",
    "generate": "nuxt generate",
    "db:generate": "drizzle-kit generate:sqlite",
    "db:push": "drizzle-kit push:sqlite",
    "db:studio": "drizzle-kit studio",
    "db:seed": "tsx db/seeds/index.ts",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "type-check": "nuxt typecheck"
  },
  "dependencies": {
    "@element-plus/nuxt": "^1.0.8",
    "@googlemaps/js-api-loader": "^1.16.2",
    "@nuxt/image": "^1.1.0",
    "@pinia/nuxt": "^0.5.1",
    "@vueuse/nuxt": "^10.7.0",
    "better-sqlite3": "^9.2.2",
    "drizzle-orm": "^0.29.3",
    "element-plus": "^2.4.4",
    "nuxt": "^3.8.4",
    "pinia": "^2.1.7",
    "vue": "^3.4.0"
  },
  "devDependencies": {
    "@nuxt/devtools": "^1.0.8",
    "@nuxtjs/tailwindcss": "^6.8.4",
    "@types/better-sqlite3": "^7.6.8",
    "@types/google.maps": "^3.54.10",
    "drizzle-kit": "^0.20.9",
    "eslint": "^8.56.0",
    "typescript": "^5.3.3",
    "tsx": "^4.7.0"
  }
}
```

### 2.2 nuxt.config.ts
```typescript
export default defineNuxtConfig({
  devtools: { enabled: true },
  
  modules: [
    '@nuxtjs/tailwindcss',
    '@element-plus/nuxt',
    '@pinia/nuxt',
    '@vueuse/nuxt',
    '@nuxt/image'
  ],
  
  css: [
    '~/assets/css/main.css'
  ],
  
  runtimeConfig: {
    // 私有環境變數 (僅服務端可用)
    claudeApiKey: process.env.CLAUDE_API_KEY,
    databaseUrl: process.env.DATABASE_URL || './data/tourism.db',
    
    public: {
      // 公開環境變數 (客戶端可用)
      googleMapsKey: process.env.GOOGLE_MAPS_KEY,
      appUrl: process.env.NUXT_PUBLIC_APP_URL || 'http://localhost:3000',
      appName: 'Taiwan Tourism Map'
    }
  },
  
  nitro: {
    experimental: {
      wasm: true
    },
    // 預渲染設定
    prerender: {
      routes: ['/sitemap.xml']
    }
  },
  
  // PWA 配置
  app: {
    head: {
      title: 'Taiwan Tourism Map',
      meta: [
        { charset: 'utf-8' },
        { name: 'viewport', content: 'width=device-width, initial-scale=1' },
        { name: 'description', content: 'Discover amazing tourism activities in Taiwan' }
      ],
      link: [
        { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },
        { rel: 'manifest', href: '/manifest.json' }
      ]
    }
  },
  
  // TypeScript 配置
  typescript: {
    strict: true,
    typeCheck: true
  }
});
```

### 2.3 drizzle.config.ts
```typescript
import type { Config } from 'drizzle-kit';

export default {
  schema: './db/schema.ts',
  out: './db/migrations',
  driver: 'better-sqlite',
  dbCredentials: {
    url: process.env.DATABASE_URL || './data/tourism.db'
  },
  verbose: true,
  strict: true
} satisfies Config;
```

### 2.4 tailwind.config.js
```javascript
module.exports = {
  content: [
    './components/**/*.{js,vue,ts}',
    './layouts/**/*.vue',
    './pages/**/*.vue',
    './plugins/**/*.{js,ts}',
    './app.vue'
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8'
        },
        secondary: {
          50: '#f0fdf4',
          500: '#10b981',
          600: '#059669'
        }
      },
      fontFamily: {
        sans: ['Inter', 'sans-serif']
      },
      spacing: {
        '18': '4.5rem',
        '88': '22rem'
      }
    }
  },
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography')
  ]
};
```

## 3. 開發工作流程

### 3.1 初始化專案
```bash
# 1. 建立 Nuxt 專案
npx nuxi@latest init nuxt-tourism-map

# 2. 進入專案目錄
cd nuxt-tourism-map

# 3. 安裝依賴
npm install

# 4. 安裝額外套件
npm install @element-plus/nuxt @pinia/nuxt @vueuse/nuxt
npm install drizzle-orm better-sqlite3
npm install -D drizzle-kit @types/better-sqlite3

# 5. 初始化資料庫
npm run db:generate
npm run db:push
npm run db:seed
```

### 3.2 開發命令
```bash
# 開發模式
npm run dev

# 構建生產版本
npm run build

# 預覽生產版本
npm run preview

# 資料庫管理
npm run db:studio    # 開啟 Drizzle Studio
npm run db:seed      # 執行種子資料

# 代碼品質
npm run lint         # 檢查代碼風格
npm run type-check   # TypeScript 類型檢查
```

## 4. Git 工作流程

### 4.1 .gitignore
```
# Nuxt 相關
.nuxt
.output
.env
.env.*
!.env.example

# 資料庫
/data/
*.db
*.db-journal

# 依賴
node_modules/

# 日誌
logs/
*.log

# 編輯器
.vscode/
.idea/

# 系統文件
.DS_Store
Thumbs.db
```

### 4.2 分支策略
```
main         # 生產環境
├── develop  # 開發環境
├── feature/ # 功能分支
├── hotfix/  # 緊急修復
└── release/ # 發佈分支
```

## 5. 程式碼規範

### 5.1 命名慣例
```typescript
// 文件命名: kebab-case
activity-card.vue
use-activities.ts

// 組件命名: PascalCase
export default defineComponent({
  name: 'ActivityCard'
});

// 變數命名: camelCase
const activityList = ref([]);
const isLoading = ref(false);

// 常數命名: SNAKE_CASE
const API_BASE_URL = 'https://api.example.com';
const MAX_RADIUS_KM = 50;
```

### 5.2 組件結構
```vue
<template>
  <!-- 模板內容 -->
</template>

<script setup lang="ts">
// 1. 引入
import { ref } from 'vue';

// 2. 類型定義
interface Props {
  activity: Activity;
}

// 3. Props 和 Emits
const props = defineProps<Props>();
const emit = defineEmits<{
  click: [activity: Activity];
}>();

// 4. 響應式變數
const isVisible = ref(false);

// 5. Composables
const { favorites } = useFavorites();

// 6. 計算屬性
const isActive = computed(() => {
  return props.activity.status === 'active';
});

// 7. 方法
function handleClick() {
  emit('click', props.activity);
}

// 8. 生命週期
onMounted(() => {
  console.log('Component mounted');
});
</script>

<style scoped>
/* 組件樣式 */
</style>
```

## 6. 測試策略

### 6.1 測試類型
```yaml
單元測試:
  - Composables 邏輯測試
  - 工具函數測試
  - 組件行為測試

整合測試:
  - API 端點測試
  - 資料庫查詢測試
  - 組件互動測試

端到端測試:
  - 用戶流程測試
  - 跨瀏覽器測試
  - 行動裝置測試
```

### 6.2 測試工具
```json
{
  "devDependencies": {
    "@nuxt/test-utils": "^3.8.4",
    "vitest": "^1.1.0",
    "playwright": "^1.40.0",
    "@vue/test-utils": "^2.4.3"
  }
}
```

## 7. 部署準備

### 7.1 環境變數範例
```bash
# .env.example
# Google Maps API
GOOGLE_MAPS_KEY=your_google_maps_api_key

# Claude API (用於資料驗證)
CLAUDE_API_KEY=your_claude_api_key

# 資料庫
DATABASE_URL=./data/tourism.db

# 應用設定
NUXT_PUBLIC_APP_URL=https://yourdomain.com
NUXT_PUBLIC_APP_NAME=Taiwan Tourism Map

# 分析工具 (可選)
GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
```

### 7.2 生產環境檢查清單
```yaml
□ 環境變數設定完成
□ 資料庫初始化完成
□ 靜態資源優化完成
□ SEO 設定完成
□ 錯誤處理機制完成
□ 效能監控設定完成
□ 安全性檢查完成
□ 備份策略準備完成
```

這個專案結構為 Nuxt.js 觀光活動地圖提供了完整的開發框架，確保程式碼的可維護性和擴展性。