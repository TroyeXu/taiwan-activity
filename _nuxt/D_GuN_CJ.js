import{o as h,r as l,M as x,q as r,t as i,v as t,ar as C,y as o,F as b,ay as w,az as k,bD as D}from"./CX06qJIc.js";const N={class:"container mx-auto p-4"},E={class:"space-y-4"},q={class:"bg-blue-100 p-4 rounded"},F={key:0},L={key:1,class:"text-green-600"},R={key:2,class:"text-red-600"},S={class:"bg-gray-100 p-4 rounded"},B={class:"text-sm space-y-1"},M=["href"],T=["disabled"],j=h({__name:"cdn-test",setup(U){const c=l(!1),p=l(!1),u=l(""),f=l(0),v=l([]),m=["https://cdn.jsdelivr.net/gh/TroyeXu/taiwan-activity@main/public/tourism.sqlite","https://raw.githubusercontent.com/TroyeXu/taiwan-activity/main/public/tourism.sqlite"],y=async()=>{c.value=!0,p.value=!1,u.value="";try{console.log("🚀 開始 CDN 測試...");const a=await D({locateFile:s=>`https://sql.js.org/dist/${s}`});let e=null;for(const s of m)try{console.log(`📥 嘗試: ${s}`);const d=await fetch(s);if(d.ok){e=await d.arrayBuffer(),console.log(`✅ 成功載入 (${(e.byteLength/1024/1024).toFixed(2)} MB)`);break}}catch(d){console.error(`❌ 失敗: ${s}`,d)}if(!e)throw new Error("無法從任何 CDN 載入資料庫");const n=new a.Database(new Uint8Array(e)),_=n.exec("SELECT COUNT(*) as count FROM activities");f.value=_[0]?.values[0][0]||0;const g=n.exec("SELECT name FROM sqlite_master WHERE type='table'");v.value=g[0]?.values.map(s=>s[0])||[],p.value=!0,console.log("✅ 測試成功！")}catch(a){u.value=String(a),console.error("❌ 測試失敗:",a)}finally{c.value=!1}};return x(()=>{y()}),(a,e)=>(i(),r("div",N,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold mb-4"},"CDN 資料庫載入測試",-1)),t("div",E,[t("div",q,[e[1]||(e[1]=t("h2",{class:"text-lg font-semibold mb-2"},"測試狀態",-1)),o(c)?(i(),r("div",F,"載入中...")):o(p)?(i(),r("div",L,[e[0]||(e[0]=t("p",null,"✅ 資料庫載入成功！",-1)),t("p",null,"活動數量: "+b(o(f)),1),t("p",null,"資料表: "+b(o(v).join(", ")),1)])):o(u)?(i(),r("div",R,[t("p",null,"❌ 錯誤: "+b(o(u)),1)])):C("",!0)]),t("div",S,[e[2]||(e[2]=t("h2",{class:"text-lg font-semibold mb-2"},"CDN URLs",-1)),t("ul",B,[(i(),r(w,null,k(m,n=>t("li",{key:n},[t("a",{href:n,target:"_blank",class:"text-blue-600 hover:underline"},b(n),9,M)])),64))])]),t("button",{onClick:y,class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",disabled:o(c)}," 測試 CDN 載入 ",8,T)])]))}});export{j as default};
